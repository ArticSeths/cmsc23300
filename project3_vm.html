
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Project 3 Virtual Machine &#8212; CMSC 23300 - Networks and Distributed Systems</title>

    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/chiweb.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Project 3 Rubric" href="project3_rubric.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          CMSC 23300 - Networks and Distributed Systems</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="syllabus.html">Syllabus</a></li>
                <li><a href="calendar.html">Course Calendar</a></li>
                <li><a href="resources.html">Additional Resources</a></li>
                <li><a href="projects.html">Projects</a></li>
            
            
              
              
            
            
            
            
            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
<div class="row">
    <div class="col-md-12">
        <ul class="breadcrumb">
          <li><a href="index.html">CMSC 23300 - Networks and Distributed Systems</a></li>
          <li><a href="projects.html">Projects</a></li>
            <li class="active">Project 3 Virtual Machine</li>
        </ul>
    </div>
</div>

    <div class="col-md-12 content">
      
  <div class="section" id="project-3-virtual-machine">
<h1>Project 3 Virtual Machine<a class="headerlink" href="#project-3-virtual-machine" title="Permalink to this headline">¶</a></h1>
<p>The mininet network simulator in Project 3 must be run with root privileges
on a Linux machine. If you do not have access to such a machine, we recommend
using a virtual machine to run mininet. Take into account that this doesn’t
mean you have to do all your development work inside the virtual machine; you
will be able to continue to use your usual development environment (your laptop,
a CSIL machine, etc.), and will simply instruct chirouter to connect to the instance
of mininet running on the virtual machine (instead of running mininet directly
on your machine).</p>
<p>Although mininet provides some ready-to-use VMs, we will be using our own
VM image. This is an Ubuntu image that closely mirrors the standard CS
Linux environment, and which our Techstaff is deeply familiar with if we
run into any issues. Furthemore, this VM image can be run with VirtualBox,
an open source virtualization software package.</p>
<p>Please note that the VM <strong>does not recognize CNetIDs, nor will it have access to your CS
home directory</strong>. However, as we explain below, you will be able to develop
your code in your environment of choice, and then use the VM only when you
need to test your code (and you will not even have to copy your code into the VM;
your chirouter implementation can run on your own machine, and then communicate
with mininet and POX on the VM).</p>
<p>You can download the VM here:</p>
<blockquote>
<div><p><a class="reference external" href="http://mirror.cs.uchicago.edu/techstaff/cs233-win-17.ova">http://mirror.cs.uchicago.edu/techstaff/cs233-win-17.ova</a> [3.3 GB]</p>
<p>MD5: 75519a792d99b747789a8e036a344751</p>
</div></blockquote>
<p>To get the VM running on Windows or OS X, just follow the instructions provided
<a class="reference external" href="https://www.classes.cs.uchicago.edu/archive/2016/fall/12100-1/install-guide/index-download.html">on the CS 121 website</a> (that class
used a similar VM). However, please note the following exceptions:</p>
<ul class="simple">
<li>Instead of the <code class="docutils literal"><span class="pre">cs121-aut-15-final.ova</span></code> file referred to in that page, use the
OVA file you downloaded from the URL above.</li>
<li>You can download the latest version of VirtualBox (you don’t need to use the 5.0.4
version specified in those instructions)</li>
<li>If installing on OS X, you can skip steps 8 and 9, and all the steps after (and including) step 16.</li>
<li>If installing on Windows, you can skip steps 7 and 8, and all the steps after (and including) step 14.</li>
</ul>
<p>Make sure you start the VM on an Internet-connected machine. Once you do so, log into
the VM (username: <code class="docutils literal"><span class="pre">student</span></code>, password: <code class="docutils literal"><span class="pre">uchicago</span></code>). The software to run mininet
and POX is already installed on the VM, and you can
use the VM in one of two ways:</p>
<ul class="simple">
<li>Developing your code directly on the VM</li>
<li>Developing your code elsewhere, and using the VM only to run mininet.</li>
</ul>
<p>Please follow the instructions below for the appropriate case:</p>
<div class="section" id="using-the-vm-as-your-development-environment">
<h2>Using the VM as your development environment<a class="headerlink" href="#using-the-vm-as-your-development-environment" title="Permalink to this headline">¶</a></h2>
<p>If you do this, you do not need to configure your VM further, and you
will be able to run the mininet and POX commands as described in the
chirouter documentation.</p>
<p>However, you will need to clone your repository inside the VM, which
will require generating and upload SSH keys as described in
<a class="reference external" href="http://uchicago-cs.github.io/cmsc23300/initial_code.html">Uploading the initial code to your repository</a></p>
<p>Nonetheless, you may want to run the following to disable Ubuntu’s Network
Manager, as it can sometimes interfere with the virtual networking
devices created by mininet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">network</span><span class="o">-</span><span class="n">manager</span> <span class="n">stop</span>
</pre></div>
</div>
<p>Note: You will have to re-run this command if you reboot the VM.</p>
</div>
<div class="section" id="using-the-vm-only-to-run-mininet">
<h2>Using the VM only to run mininet<a class="headerlink" href="#using-the-vm-only-to-run-mininet" title="Permalink to this headline">¶</a></h2>
<p>In this case, you will run POX and mininet inside the VM, but you will
develop and run your chirouter code elsewhere (typically, on the machine
that is running the VM).</p>
<p>To run POX and mininet, the VM already includes a clone of the chirouter repository
in your home directory, and you should run POX and mininet
from the <code class="docutils literal"><span class="pre">~/chirouter/</span></code> directory. <strong>You do not neet to clone your
team’s repository in the VM</strong>. Instead,
your team repository will be in the host machine (i.e., the machine
that is running the VM). You will build and run chirouter on the
host machine, and then instruct chirouter to connect to POX/mininet
on the VM.</p>
<p>However, while VirtualBox will, by default, allow your VM to access the
Internet using the host machine’s network, it won’t allow
the VM and the host machine to communicate directly, so we
need to change your VM’s network configuration to use “Host Only” mode.</p>
<p>To do this, you must first create a Host-only Network. On VirtualBox,
go to File -&gt; Preferences -&gt; Network -&gt; Host-only Networks, and then
click on the plus icon.</p>
<p>Next, before starting your VM, click on Settings -&gt; Network, and
select “Host-only Adapter” under “Attached to”. Note that you can
also do this while the VM is running by clicking on the network icon
on the bottom-left corner of the VM window (the network icon is the one
with two computers).</p>
<p>Then, from a terminal in the VM, run the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">network</span><span class="o">-</span><span class="n">manager</span> <span class="n">stop</span>
</pre></div>
</div>
<p>This will stop Ubuntu’s Network Manager, which can interfere with
the virtual network devices created by mininet. Note: You will have
to re-run this commands if you reboot the VM.</p>
<p>Next, you need to find out what IP address has been assigned to your
machine. Run this from inside the VM:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ifconfig</span>
</pre></div>
</div>
<p>The network interface for your VM may not have the usual <code class="docutils literal"><span class="pre">ethX</span></code> name,
so you should look for an interface with a private IP address, typically
something like 192.168.56.101. You should
verify that you can ping this IP address from the host machine.</p>
<p>Now, when you run chirouter, you must include an <code class="docutils literal"><span class="pre">-s</span></code> option to
specify that you’re connecting to POX/mininet on a different machine.
For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">chirouter</span> <span class="o">-</span><span class="n">s</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">56.101</span> <span class="o">-</span><span class="n">p</span> <span class="mi">9999</span> <span class="o">-</span><span class="n">r</span> <span class="n">topologies</span><span class="o">/</span><span class="n">basic</span><span class="o">/</span><span class="n">rtable9999</span> <span class="o">-</span><span class="n">vv</span>
</pre></div>
</div>
<p>Note: setting the VM to Host-only Networking will prevent the VM from accessing
the Internet. If you later on realize you need to access the Internet from the VM,
just go back to the Network settings and switch the “Attached to” option to “NAT”.</p>
</div>
<div class="section" id="common-issues-when-running-the-vm">
<h2>Common issues when running the VM<a class="headerlink" href="#common-issues-when-running-the-vm" title="Permalink to this headline">¶</a></h2>
<div class="section" id="enabling-virtualization-extensions">
<h3>Enabling virtualization extensions<a class="headerlink" href="#enabling-virtualization-extensions" title="Permalink to this headline">¶</a></h3>
<p>If you try to run the VM and VirtualBox shows a message like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Failed</span> <span class="n">to</span> <span class="nb">open</span> <span class="n">a</span> <span class="n">session</span> <span class="k">for</span> <span class="n">the</span> <span class="n">virtual</span> <span class="n">machine</span> <span class="n">CMSC23300</span><span class="o">.</span>

<span class="n">VT</span><span class="o">-</span><span class="n">x</span> <span class="ow">is</span> <span class="n">disabled</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">BIOS</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">CPU</span> <span class="n">modes</span> <span class="p">(</span><span class="n">VERR_VMX_MSR_ALL_VMX_DISABLED</span><span class="p">)</span><span class="o">.</span>
<span class="n">Result</span> <span class="n">Code</span><span class="p">:</span>        <span class="n">E_FAIL</span> <span class="p">(</span><span class="mh">0x80004005</span><span class="p">)</span>
<span class="n">Component</span><span class="p">:</span>  <span class="n">ConsoleWrap</span>
<span class="n">Interface</span><span class="p">:</span>  <span class="n">IConsole</span> <span class="p">{</span><span class="mi">872</span><span class="n">da645</span><span class="o">-</span><span class="mi">4</span><span class="n">a9b</span><span class="o">-</span><span class="mi">1727</span><span class="o">-</span><span class="n">bee2</span><span class="o">-</span><span class="mi">5585105</span><span class="n">b9eed</span><span class="p">}</span>
</pre></div>
</div>
<p>This means that your computer’s “virtualization extensions” (which enables the CPU to efficiently run virtual machines) have not been activated. You can usually activate them by rebooting your computer and going into the BIOS menu (usually by pressing Esc or Shift at boot; if your computer is nice, it will probably tell you exactly what key to press to interrupt the computer’s bootup and to go into the BIOS menu)</p>
<p>Once there, you’ll have to look around for the option to turn on “VT-X” or “VMX” or some variation of the term “Virtualization Extensions”. If you’re unsure on how to do any of this, try Googling for your computer’s brand/model along with “BIOS menu” or “virtualization”. This will likely turn up the appropriate instructions for your machine.</p>
</div>
<div class="section" id="corrupted-download">
<h3>Corrupted download<a class="headerlink" href="#corrupted-download" title="Permalink to this headline">¶</a></h3>
<p>If VirtualBox complains about trying to import or launch a corrupted VM, make sure the OVA file
you downloaded was correctly downloaded. You can check the integrity of the file by running
the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">md5sum</span> <span class="n">cs233</span><span class="o">-</span><span class="n">win</span><span class="o">-</span><span class="mf">17.</span><span class="n">ova</span>
</pre></div>
</div>
<p>The resulting MD5 hash should match the one shown at the top of this page. If it doesn’t,
try re-downloading the file. We recommend using <code class="docutils literal"><span class="pre">wget</span></code> or <code class="docutils literal"><span class="pre">curl</span></code>, which will usually
deal better with resuming an interrupted download.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011-2018, The University of Chicago.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>